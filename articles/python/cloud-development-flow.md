---
title: Azure 開発フロー
description: プロビジョニング、コーディング、テスト、デプロイ、管理を伴う Azure でのクラウド開発サイクルの概要。
ms.date: 05/12/2020
ms.topic: conceptual
ms.openlocfilehash: 577b813e2b4ccd8d2cae3d7999d9bb959f88adc2
ms.sourcegitcommit: 2cdf597e5368a870b0c51b598add91c129f4e0e2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/14/2020
ms.locfileid: "83404965"
---
# <a name="the-azure-development-flow-provision-code-test-deploy-and-manage"></a>Azure の開発フロー: プロビジョニング、コーディング、テスト、デプロイ、管理

[前回の記事: リソースのプロビジョニング、アクセス、管理](cloud-development-provisioning.md)

Azure のサービスとリソースのモデルを理解したら、**プロビジョニング**、**コーディング**、**テスト**、**デプロイ**、**管理**という、Azure を使用したクラウド アプリケーションの全体的な開発フローを理解することができます。

## <a name="step-1-provision-and-configure-resources"></a>手順 1:リソースのプロビジョニングと構成を行う

[このシリーズにおける前回の記事](cloud-development-provisioning.md)で説明したように、アプリケーション開発の最初のステップは、アプリケーションのターゲット環境を成り立たせるリソースのプロビジョニングと構成です。

プロビジョニングではまず、適切な Azure リージョンにリソース グループを作成します。 リソース グループの作成は、Azure portal や Azure CLI から行えるほか、Azure SDK (または REST API) を使用するカスタム スクリプトで行うことができます。

その後、やはりポータル、CLI、Azure SDK のいずれかを使用して、そのリソース グループ内に、必要な各リソースをプロビジョニングし、それらを構成します。 構成には、どの ID (サービス プリンシパルまたはアプリケーション ID) がそれらのリソースにアクセスできるかを制御するアクセス ポリシーの設定が含まれます。

ほとんどの開発シナリオでは、Azure CLI と Python コードまたはそのいずれかで、Azure SDK を使用してプロビジョニング スクリプトを作成することになります。 そのスクリプトは、アプリケーションの全体的なリソース ニーズを表すものです。スクリプトを通じて、開発、テスト、運用という異なる環境にそれらのリソースを簡単に再作成することができます。Azure portal から手動で、多数の手順を繰り返し行う必要はありません。 また、別のリージョンに環境をプロビジョニングしたり、異なるリソース グループを使用したりすることも、そのスクリプトがあれば簡単にできます。 さらに、完全な監査と変更履歴が得られるよう、それらのスクリプトはソース管理リポジトリで保守することができます。

## <a name="step-2-write-your-app-code-to-use-resources"></a>手順 2:リソースを使用するアプリ コードを作成する

アプリケーションに必要なリソースをプロビジョニングしたら、それらのリソース (コード自体のデプロイ先となるリソースを除く) と連動するアプリケーション コードを作成します。

たとえばプロビジョニング手順で、Azure Storage アカウントを作成し、そのアカウントに BLOB コンテナーを作成して、そのコンテナー上のアプリケーションのアクセス ポリシーを設定したとします。 今度は、自分のコードから、そのストレージ アカウントに対する認証を行った後、そのコンテナー内の BLOB を作成、更新、削除することができます (このプロセスについては、[Azure Storage の使用例](azure-sdk-example-storage.md)に関するページでデモンストレーションを行っています)。同様に、スキーマと適切なアクセス許可を使用してデータベースをプロビジョニングしたとすれば、アプリケーション コードから、そのデータベースに接続して、通常の操作 (作成、読み取り、更新、削除) を実行することができます。

Python 開発者であれば、Azure SDK for Python を Python から使用してアプリケーション コードを作成するのが一般的です。 とはいえ、クラウド アプリケーションを構成する独立したパーツは、サポートされている任意の言語で作成できます。 たとえば、言語の得意分野に多様性があるチームで作業している場合、アプリケーションの領域ごとに Python、JavaScript、Java、C# などを使い分けることも十分可能です。

アプリケーション コードは、Azure SDK を使用して、プロビジョニング操作と管理操作を必要に応じて実行できることに注意してください。 同様に、プロビジョニング スクリプトから SDK を使用して、特定のデータでリソースを初期化したり、クラウド リソースに対するハウスキープ処理タスクを実行したりすることができます。それらのスクリプトがローカルで実行されていても同様です。

## <a name="step-3-test-and-debug-your-app-code-locally"></a>手順 3:アプリ コードのテストとデバッグをローカルで行う

一般に開発者は、アプリのコードを各自のローカル ワークステーションでテストしてから、クラウドにデプロイしたいと考えます。アプリのコードをローカルでテストするとは、通常、既にクラウドにプロビジョニングしてある他のリソース (ストレージ、データベースなど) にアクセスすることを意味します。 違いは、アプリのコード自体がまだクラウド サービス内で実行されていないだけです。

また、コードをローカルで実行することにより、Visual Studio Code などのツールに備わっているデバッグ機能を最大限に活用すると共に、ソース管理リポジトリで自分のコードを管理することができます。

ローカル テストのために、コードを変更する必要は一切ありません。Azure では、クラウドにデプロイするものと同じコードを使用して、すべての開発とデバッグをローカルで行うことができます。 ここで鍵となるのが環境変数です。クラウドでは、ホスティング リソースの設定を環境変数としてコードから利用することができます。 同じ環境変数をローカルにも作成することにより、同じコードが変更なしに動作します。 このパターンは、認証の資格情報、リソースの URL、接続文字列など、さまざまな設定で役立ちます。コードをローカルで実行するときには開発環境のリソースを、また、コードがクラウドにデプロイされた後は運用環境のリソースを簡単に使用できるようになります。

## <a name="step-4-deploy-your-app-code-to-azure"></a>手順 4:アプリのコードを Azure にデプロイする

コードをローカルでテストしたら、いよいよ、そのホストとなるプロビジョニング済みの Azure リソースにコードをデプロイすることになります。 たとえば、Django Web アプリケーションを作成している場合、そのコードを仮想マシン (この場合は独自の Web サーバーを用意) または Azure App Service (最初から Web サーバーが用意されている) にデプロイします。 デプロイされたコードは、ローカル コンピューター上ではなくサーバー上で実行され、承認されたあらゆる Azure リソースにアクセスすることができます。

前のセクションで触れたように、通常の開発プロセスでは、まず、開発環境のプロビジョニング済みリソースにコードをデプロイします。 何度かテストを重ねた後、ステージング環境のリソースにコードをデプロイします。アプリケーションはテスト チームに公開されます。そこにはプレビュー ユーザーも含まれるかもしれません。 アプリケーションのパフォーマンスに問題がなければ、運用環境にコードをデプロイすることができます。 これらのデプロイはすべて、Azure DevOps を使用した継続的インテグレーションと継続的デプロイを通じて自動化することもできます。

どのような方法で行うにせよ、クラウドにデプロイしたコードは、紛れもなくクラウド アプリケーションとなり、完全に Azure のデータ センター内のサーバー コンピューター上で実行されます。

## <a name="step-5-manage-monitor-and-revise"></a>手順 5:管理、監視、修正する

デプロイ後は、アプリケーションが意図したとおりに動作して、ユーザーからの要求に応答し、リソースを効率よく (かつ最小限のコストで) 使用していることを確認する必要があります。 デプロイの必要に応じた自動スケーリング方法を管理できるほか、Azure portal または Azure CLI を使用して、あるいは Azure SDK で作成されたカスタム スクリプトを使用して、パフォーマンス データを収集、監視することもできます。 その後、再び同じツールをどれでも使用して、プロビジョニング済みのリソースをリアルタイムで調整し、パフォーマンスを最適化することができます。

クラウド アプリケーションを再構築する方法についての分析情報は、監視によって得られます。 たとえば、Web アプリの特定の部分 (一連の API エンドポイントなど) が、主な部分と比較してまれにしか使用されていないと判明する場合があります。 その場合は、それらの API を切り離してサーバーレスの Azure Functions としてデプロイすれば、メインのアプリケーションと競合せず、それでいて毎月のコストも少額で済む専用のバッキング コンピューティング リソースを利用することができます。 高額の価格レベルにスケールアップすることなく、メイン アプリケーションで処理できるユーザー数を増やし、応答性を高めることができます。

## <a name="next-steps"></a>次のステップ

以上、Azure の基本的な構造と全体的な開発フローについて説明しました。リソースのプロビジョニング、コードの作成とテスト、Azure へのコードのデプロイ、それらのリソースの監視と管理についてご理解いただけかと思います。

次のステップでは、そのフローに対応するための万全な構成をワークステーションに対して行います。それが済んだら、いよいよ Azure SDK に取り組みます。

> [!div class="nextstepaction"]
> [ローカル開発環境を構成する >>>](configure-local-development-environment.md)
